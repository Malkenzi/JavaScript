<!DOCTYPE html>
<html> <lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>my babySnake</title>
    <style>
    body {
    background: #ffbf00;
    text-align: center;
    }

    canvas {
    border :10px solid #f7347a;
    }
h1{
    font-family:'Avenir Next', Verdana;
    font-weight: bold;
}
    </style>
</head>

<body>
<canvas width="800" height="800"></canvas>
<h1> Bejby Snejk</h1>


<script>
// listeners
document.addEventListener('keydown', keyPush)


//canvas
const canvas = document.querySelector('canvas');
const title = document.querySelector('h1');
const ctx = canvas.getContext('2d');

//player
const snakeSize = 40; 

let snakeSpeed = snakeSize;
let snakePosX = 0
let snakePosY = canvas.height/2;

let velocityX = 0;
let velocityY = 0;

// game
const tileCountX = canvas.width/snakeSize; //pocet Dlazd
const tileCountY = canvas.height/snakeSize;

let score = 0;

//fooooooooooooooood
let foodPosX = 0;
let foodPosY = 0;

//loop
function gameLoop(){
drawStuff();
moveStuff();
setTimeout(gameLoop, 1000 / 15);  // pre rychlejsi framerate requestAnimationFrame(gameLoop);
}

resetFood(); //po spusteni hry sa resetne pozicia jedla
gameLoop();

//
//MOVE EVERYTHING
//

function moveStuff(){
snakePosX += snakeSpeed * velocityX;
snakePosY += snakeSpeed * velocityY;


// wall collision
if(snakePosX > canvas.width - snakeSize){ //kontrola laveho horneho rohu, preto -snakeSize
snakePosX = 0;
}
if (snakePosX < 0){
snakePosX = canvas.width;
}
if(snakePosY > canvas.height - snakeSize){
snakePosY = 0;
}
if (snakePosY < 0){
snakePosY = canvas.height;
}
// food collision
if (snakePosX == foodPosX && snakePosY == foodPosY){
    title.textContent = ++score;
    resetFood();
    
}
}

//
//DRAW EVERYTHING
//

function drawStuff(){

//background
rectangle("gray", 0, 0, canvas.width, canvas.height)

//grid
drawGrid();

//food
rectangle("red",foodPosX, foodPosY, snakeSize, snakeSize)

//snake
rectangle("green", snakePosX,snakePosY, snakeSize, snakeSize)

}
// draw rectangle
function rectangle(color, x, y, width, height){
ctx.fillStyle = color;
ctx.fillRect (x, y, width, height);
}

// Randomize food position
function resetFood(){
    foodPosX = Math.floor(Math.random() * tileCountX) * snakeSize; //math.floor=zaukruhli random cislo
    foodPosY = Math.floor(Math.random() * tileCountY) * snakeSize; //math.
}
//
// KEYBOARD
//
function keyPush(event){
    switch(event.key){
        case 'ArrowLeft':
        if(velocityX !== 1){
            velocityX = -1;
            velocityY = 0;
        }
            break;
        case 'ArrowUp':
            if(velocityY !== 1){
            velocityX = 0;
            velocityY = -1;
        }
            break;
        case 'ArrowRight':
        if(velocityX !== -1){
            velocityX = 1;
            velocityY = 0;
        }
            break;
        case 'ArrowDown':
            if(velocityY !== -1){
            velocityX = 0;
            velocityY = 1;
        }
            break;
    }
}
function drawGrid(){
    for(let i =0; i < tileCountX; i++){
    for(let j =0; j < tileCountY; j++){
    rectangle ("#fff",snakeSize * i,snakeSize *j ,snakeSize-1,snakeSize-1 );
}
}
}
</script>
</body>

</html>